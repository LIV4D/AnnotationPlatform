<!-- TaskType Selector -->
<div class="taskTypeSelector">
  <mat-form-field id="taskTypeFilterForm" >
    <mat-select #select placeholder="Select a Task type" (selectionChange)="applyFilter($event.value)"id="taskTypeFilterSelector" >
      <mat-option *ngFor="let taskType of taskTypes" [value]="taskType">
        {{taskType.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
</div>

<!-- Table -->
<section class="TasksToCompleteDataSource">
  <mat-table #table [dataSource]="dataSource" matSort matSortActive="projectTitle" matSortDirection="asc" matSortDisableClear>

    <!--Image Preview -->
    <ng-container matColumnDef="imageSrc">
        <mat-header-cell *matHeaderCellDef disableClear disableClear>Preview</mat-header-cell>
        <mat-cell *matCellDef="let task" (mouseup)="loadImage(task.imageId.toString())"> <img matTooltip="Click for loading the image" [src]="task.thumbnail | safeImage" height="64px" /> </mat-cell>
    </ng-container>

    <!-- Image Id -->
    <ng-container matColumnDef="imageId">
        <mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Id</mat-header-cell>
        <mat-cell *matCellDef="let task"> {{task.imageId}} </mat-cell>
    </ng-container>

    <!-- Project Title-->
    <ng-container matColumnDef="projectTitle">
      <mat-header-cell *matHeaderCellDef  mat-sort-header disableClear>Project</mat-header-cell>
      <mat-cell *matCellDef="let task"> {{task.projectTitle}} </mat-cell>
    </ng-container>

    <!-- Creator Name -->
    <ng-container matColumnDef="creatorId">
        <mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Creator</mat-header-cell>
        <mat-cell *matCellDef="let task">
          <ng-container *ngFor="let user of users">
            <p *ngIf="user.id === task.creatorId">{{user.firstName | uppercase | slice:0:1}}. {{user.lastName | titlecase }} </p>
          </ng-container>
        </mat-cell>
    </ng-container>

    <!-- Cumulated Time -->
    <!-- TODO: Get cumulated in Editor when it'll be operationnal -->
    <ng-container matColumnDef="time">
      <mat-header-cell *matHeaderCellDef>Cumulated Time</mat-header-cell>
      <mat-cell *matCellDef="let task"> N/A </mat-cell>
    </ng-container>

    <!-- TaskType Selected Header -->
    <ng-container [(ngModel)]="selectedTaskType" ngDefaultControl matColumnDef="selectedTaskType">
      <mat-header-cell *matHeaderCellDef> 
        {{selectedTaskType}}
      </mat-header-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="['selectedTaskType']"></mat-header-row>
    <!--mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row-->
    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
  </mat-table>

      <p *ngIf="!isCompleted && isDataEmpty" id="tasksFinishedText"> You've completed all your assigned tasks. <br />Thanks for your work! </p>
  <mat-paginator [length]="length" [pageSize]="pageSize"></mat-paginator>
</section>
